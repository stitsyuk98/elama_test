*** Reading local file: /usr/local/airflow/logs/worker/do_mat_view/2022-02-07T19:30:45.974820+00:00/3.log
[2022-02-07 20:04:52,719] {{taskinstance.py:655}} INFO - Dependencies all met for <TaskInstance: worker.do_mat_view 2022-02-07T19:30:45.974820+00:00 [queued]>
[2022-02-07 20:04:52,745] {{taskinstance.py:655}} INFO - Dependencies all met for <TaskInstance: worker.do_mat_view 2022-02-07T19:30:45.974820+00:00 [queued]>
[2022-02-07 20:04:52,745] {{taskinstance.py:866}} INFO - 
--------------------------------------------------------------------------------
[2022-02-07 20:04:52,745] {{taskinstance.py:867}} INFO - Starting attempt 3 of 3
[2022-02-07 20:04:52,745] {{taskinstance.py:868}} INFO - 
--------------------------------------------------------------------------------
[2022-02-07 20:04:52,762] {{taskinstance.py:887}} INFO - Executing <Task(PostgresOperator): do_mat_view> on 2022-02-07T19:30:45.974820+00:00
[2022-02-07 20:04:52,765] {{standard_task_runner.py:53}} INFO - Started process 25606 to run task
[2022-02-07 20:04:52,856] {{logging_mixin.py:112}} INFO - Running %s on host %s <TaskInstance: worker.do_mat_view 2022-02-07T19:30:45.974820+00:00 [running]> 1b4654a53e6f
[2022-02-07 20:04:52,884] {{postgres_operator.py:62}} INFO - Executing: CREATE MATERIALIZED VIEW IF NOT EXISTS sales_summary AS
select user_id, sum(price)
from transactions t
where exists (
    select user_id 
    from webinar w
    left join users u using(email)
    where date_registration > '2016-04-01' and t.user_id = u.user_id
        and w.email not in(
                    select email
                    from users u
                    where date_registration < '2016-04-01'
                ) )
group by user_id;
[2022-02-07 20:04:52,895] {{logging_mixin.py:112}} INFO - [2022-02-07 20:04:52,895] {{base_hook.py:84}} INFO - Using connection to: id: postgres. Host: 10.1.1.25, Port: 54322, Schema: postgres, Login: postgres, Password: XXXXXXXX, extra: None
[2022-02-07 20:04:52,903] {{logging_mixin.py:112}} INFO - [2022-02-07 20:04:52,902] {{dbapi_hook.py:174}} INFO - CREATE MATERIALIZED VIEW IF NOT EXISTS sales_summary AS
select user_id, sum(price)
from transactions t
where exists (
    select user_id 
    from webinar w
    left join users u using(email)
    where date_registration > '2016-04-01' and t.user_id = u.user_id
        and w.email not in(
                    select email
                    from users u
                    where date_registration < '2016-04-01'
                ) )
group by user_id;
[2022-02-07 20:04:52,909] {{postgres_operator.py:67}} INFO - NOTICE:  relation "sales_summary" already exists, skipping

[2022-02-07 20:04:52,920] {{taskinstance.py:1048}} INFO - Marking task as SUCCESS.dag_id=worker, task_id=do_mat_view, execution_date=20220207T193045, start_date=20220207T200452, end_date=20220207T200452
[2022-02-07 20:05:02,685] {{logging_mixin.py:112}} INFO - [2022-02-07 20:05:02,684] {{local_task_job.py:103}} INFO - Task exited with return code 0

